# Google Sheets API 整合設定指南

## 📋 概述

本指南將幫助您設定 Google Sheets API 整合，實現多用戶間留言的即時同步功能。

## 🚀 快速開始

### 步驟 1：創建 Google Apps Script 專案

1. 前往 [Google Apps Script](https://script.google.com/)
2. 點擊「新專案」
3. 將專案重新命名為「日月潭旅行手冊同步服務」

### 步驟 2：部署 Google Apps Script 代碼

1. 將 `google-apps-script.js` 檔案中的代碼複製到 Google Apps Script 編輯器中
2. 點擊「部署」→「新增部署作業」
3. 選擇類型：「網路應用程式」
4. 設定：
   - 說明：日月潭旅行手冊同步 API
   - 執行身分：我
   - 存取權：任何人
5. 點擊「部署」
6. 複製「網路應用程式 URL」（這就是您的 API URL）

### 步驟 3：設定同步服務

1. 在旅行手冊頁面中，登入您的用戶身份
2. 點擊「🔄 同步設定」按鈕
3. 在設定頁面中：
   - 貼上您的 Google Apps Script 網路應用程式 URL
   - 設定 API 金鑰（可選，建議設定以提高安全性）
   - 選擇同步間隔（建議 30 秒）
   - 啟用準即時更新（如需要）
4. 點擊「初始化 Google Sheets」
5. 點擊「測試連線」確認設定正確
6. 點擊「儲存設定」

## 🔧 進階設定

### API 金鑰設定

為了提高安全性，建議設定 API 金鑰：

1. 在 Google Apps Script 中修改 `API_KEY` 常數
2. 在同步設定頁面中輸入相同的 API 金鑰

### Webhook 設定（準即時更新）

如果您需要準即時更新功能：

1. 確保您的網站支援 HTTPS
2. 在同步設定中啟用「準即時更新」
3. 設定 Webhook URL（通常是您的網站 URL）

## 📊 功能說明

### 自動同步
- 每隔設定的時間間隔自動同步留言
- 支援離線模式，網路恢復後自動同步
- 智能衝突處理，避免資料遺失

### 手動同步
- 點擊「🔄 手動同步」立即觸發同步
- 適用於重要留言需要立即同步的情況

### 同步狀態
- 點擊「📊 同步狀態」查看詳細同步資訊
- 包含網路狀態、服務狀態、最後同步時間等

## 🛠️ 故障排除

### 常見問題

**Q: 同步按鈕沒有顯示？**
A: 請確保您已經設定用戶身份（輸入個人 ID）

**Q: 測試連線失敗？**
A: 請檢查：
- Google Apps Script URL 是否正確
- API 金鑰是否匹配
- Google Apps Script 是否已正確部署

**Q: 留言沒有同步？**
A: 請檢查：
- 網路連線是否正常
- 同步服務是否已啟動
- Google Sheets 是否有寫入權限

### 重置設定

如果遇到問題，可以重置所有設定：

1. 在同步設定頁面點擊「重置設定」
2. 重新進行設定流程

## 🔒 安全性說明

- 所有資料都儲存在您自己的 Google Sheets 中
- API 金鑰提供額外的安全保護
- 支援 HTTPS 加密傳輸
- 不會儲存任何敏感個人資訊

## 📞 技術支援

如果您在設定過程中遇到問題，請檢查：

1. 瀏覽器控制台是否有錯誤訊息
2. Google Apps Script 執行記錄
3. 網路連線狀態

---

*本指南適用於日月潭旅行手冊 Google Sheets API 整合功能*